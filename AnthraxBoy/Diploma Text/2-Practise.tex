\newpage
\parindent=1cm %красная строка
\begin{center}
		
		\section{Реализация компьютерных моделей распространения инфекционных заболеваний}
		
\end{center}


Как уже было указано  в предыдущем разделе, для реализации выбраны мультиагентная и SEIFDR модели. Как указано в целях работы, необходимо выбрать целевое заболевание и среду моделирования.

\subsection{Выбор заболевания, его краткое описание}
Прежде всего, исследуемое заболевание должно обладать ярко выраженными симптомами, что позволяет получить высокорепрезентативную  выборку.


В качества целевого заболевания для анализа выбрана геморрагическая лихорадка Эб$\acute{o}$ла -- острое вирусное высококонтагиозное заболевание, поражающие человека и других приматов, . Данное заболевание характеризуется высокой заразностью (человеческие останки остаются заразными до 50 дней 
%REF: https://www.cdc.gov/media/releases/2014/t0728-ebola.html
), коротким инкубационным периодом, резкими клиническими проявлениями и очень высокой смертностью(до 90\%, в среднем около 50\%). %REF: https://www.who.int/en/news-room/fact-sheets/detail/ebola-virus-disease
%REF: https://books.google.com/books?id=l5MtJdDhie0C&pg=PA444#v=onepage&q&f=false Singh, Sunit K.; Ruzek, Daniel, eds. (2014). Viral hemorrhagic fevers. Boca Raton: CRC Press, Taylor & Francis Group. СТР 444
Инфицирование происходит при прямом контакте через биологические жидкости, выделения, предметы. Основные симптомы (по времени проявления):  усталость, лихорадка, слабость, миалгия,  артралгия, боли в горле, чиханье и диарея,  обширные внутренние и внешние кровотечения, в том числе коагулопатия, кровохарканье, кровь в глазном белке, гиповолемический шок, приводящие к смерти. 
%REF: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3406178/
%REF: https://insights.ovid.com/crossref?an=00055735-201611000-00011
%REF: https://link.springer.com/article/10.1007%2Fs10620-015-3691-z

Данное заболевание удобно для изучения тем, что распространяется в странах с низким уровнем гигиены и медицинской поддержки, что позволяет изучить <<чистый>> вирус на <<чистой>> популяции, т.е модель, описывающая вирус, может пренебрегать медицинским мероприятиями; также имеется подробная посуточная статистика с низким уровнем шума по государствам и отдельным городам.


Типичные группы риска: медработники, участники похоронных команд или другие лица с непосредственным доступом к трупу, члены семьи и другие лица, находящиеся в тесном контакте с инфицированным, ведущие промысел во влажных экваториальных лесах охотники, при любом контакте с трупами инфицированных животных или при использовании зараженных животных в пищевой промышленности. Также в этой группе находятся все жители Центральной и  Южной (кроме ЮАР) Африки  и Западного и Восточного  побережий -- в этих регионах наблюдается низкий уровень санитарии, небезопасные промыслы на диких животных, низкий уровень медицины и образования людей в целом и неблагоприятная социально-политическая ситуация, что особенно хорошо видно на примере вспышки лихорадки Эбола в ДРК весной 2019 г.
%REF: https://www.who.int/csr/don/25-april-2019-ebola-drc/en/
%REF: https://www.who.int/csr/don/02-may-2019-ebola-drc/en/
%REF: https://www.who.int/csr/don/09-may-2019-ebola-drc/en/


\subsection{Сбор  и анализ статистики по местности}

Прежде всего, следует отметить, что низкий уровень инфраструктуры и подготовки медицинского персонала на местах вместе с большими расстояниями значительно затрудняет и <<зашумляет>> сбор статистики, поэтому среди источников для анализа необходимо выбрать наиболее авторитетный и полный, что снимет необходимость интерполяции данных и фильтрации выборки от шумов.


Усилия WHO направлены на детальный ежесуточный сбор статистики по государством и отдельным городам. Основываясь на анализе репозитория WHO %REF: https://github.com/cmrivers/ebola/
, можно утверждать, что самая детальная статистика дана по государству Сьерра-Леоне и наиболее пострадавшие города, также имеющие самую репрезентативную статистику, это Кайлахун и Кенема, что соответствует выводам %REF: Быкова. Мультиагентный подход 
.

\subsection{Общие допущения для моделей}
Как показано выше, лихорадка Эбола является высококонтагиозным заболеванием с высокой летальностью. Рассмотрим основные этапы данного заболевания в терминах симптомов и продолжительности, что важно при реализации моделей:
\begin{enumerate}
	\item Заражение. Происходит при контактах с телесными жидкостями зараженного человека или примата.
	\item Инкубационный период. Занимает от 4 до 10 дней. %REF: https://www.who.int/en/news-room/fact-sheets/detail/ebola-virus-disease
	%REF: https://www.cdc.gov/vhf/ebola/symptoms/index.html
	%REF: https://web.archive.org/web/20141129144852/http://www.njmonline.nl/getpdf.php?t=a&id=10001148
	%REF: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4205154/
	\item Явное проявление болезни. Сопровождается усталостью, жаром и болями в теле. На данном этапе наиболее важными  и опасными симптомами являются гематемезис, гемоптизис, кровотечения в ЖКТ и мелена, петехии. Данные симптомы представляют опасность здоровью инфицированного ввиду гиповолемическиго шока, но и являются основной причинной передачи заболевания между людьми. %REF: https://well.blogs.nytimes.com/2014/10/03/ebola-ask-well-spread-public-transit/
	%REF: https://www.cdc.gov/vhf/ebola/transmission/index.html
	\item Выздоровление. Обычно наступает через 1-2 недели после проявления симптомов. %REF: https://books.google.com/books?id=UgvdM8WRld4C&pg=PA332#v=onepage&q&f=false
	Считается, что после этого вырабатывается иммунитет сроком до 10 лет, однако неизвестно взаимодействие данного специфического иммунитет с другими штаммами лихорадки Эбола. %REF: https://www.cdc.gov/vhf/ebola/transmission/index.html?CDC_AA_refVal=https%3A%2F%2Fwww.cdc.gov%2Fvhf%2Febola%2Ftransmission%2Fqas.html
	На данный момент ведутся исследования в области сохранения вирулентных клеток у пострадавших даже после выздоровления. В силу спорности данного утверждения и отсутствия значимой статистки, описываемые далее модели не будет учитывать этот источник заражения. %REF: https://www.who.int/reproductivehealth/topics/rtis/ebola-virus-semen/en/
	%REF: http://www.sciencetimes.com/articles/6000/20150502/ebola-transmitted-through-sex.htm
	\item Смерть. Обычно наступает через 6-16 дней после проявления первых симптомов из-за гиповолемическиго шока. %REF: https://jgv.microbiologyresearch.org/content/journal/jgv/10.1099/vir.0.067199-0
	Важно заметить, что умершие тела все еще являются источником заражения, поэтому вероятность контакта между умершими и здоровыми людьми учитывается в описываемых далее моделях.
\end{enumerate}
Важно заметить, что в нулевой момент времени вся популяция не  может находиться в состоянии <<Suspected>>, иначе распространение болезни происходить не будет, т.е в модели вводится параметр, отвечающий за начальное количество людей, находящимся в инкубационном периоде, т.е в состоянии <<Exposed>>  в терминах SEIFDR модели.   
\subsection{Выбор средств моделирования}

Для построения SEIFDR модели требуется имитационное ПО, способное решать системы дифференциальных уравнений и гибкого визуализировать результаты моделирования, а также сопоставлять их с реальными результатами. При этом ПО не должно быть привязано к конкретной популяции, но должна быть возможность точно и гибко калибровать модель. Для анализа были взяты NetLogo, SOARS  и AnyLogic. NetLogo был отброшен, т.к является ПО для обучения и  требует модификации для сложных вычислений и экспериментов на внешних языках программирования. SOARS также был отброшен, т.к не имеет возможности решать системы дифференциальных уравнений. Оптимальным выбором был признан AnyLogic, т.к данное ПО является популярным промышленным решением, обладает методами для численного решения систем дифференциальных уравнений, инструментами для проведения оптимизационных экспериментов и инструментами для построения графических интерфейсов пользователя.


Для построения мультиагентной модели был выбран язык программирования Python в связке с библиотеками NetworkX %REF: https://networkx.github.io/
, используемой для построения графа локаций 
и WolframClient 1.0.2 %REF:https://pypi.org/project/wolframclient/
, используемой для прямого взаимодействия с системой компьютерной алгебры Wolfram Alpha, что позволяет отказаться от изучения и использования NumPy и SciPy %REF: https://www.wolframalpha.com/about/
.

\subsection{Построение SEIFDR модели и ее оптимизация}
Данная модель представляет собой систему дифференциальных нелинейных уравнений %REF: http://mathworld.wolfram.com/Kermack-McKendrickModel.html
и имеет ряд переменных, описывающих вероятность контакта и смерти. Очевидно, что каждое заболевание имеет свой характер и, следовательно, свое значение этих параметров. Таким образом, основной задачей при построении данной модели является проведение ряда экспериментов с целью подбора этих параметров с последующим тестированием на другой популяции, что позволит подтвердить правильность подбора данных параметров. Результатом работы модели будет  количество больных, умерших и выздоровевших в каждый дискретный момент времени.

При построении данной модели возможно использовать средства AnyLogic из палитры <<Системная динамика>>: количество людей в каждом стоянии описывается одноименным накопителем, а переменные, отвечающие за интенсивность контактов, вероятность смерти и т.д., представляют собой статические параметры. В силу простоты модели и незначительного количества связей между параметрами и накопителями, вместо использования потоков возможно применить связи -- это не оказывает влияния на решение системы дифференциальных уравнений. 
%IMG: скрин модели 

После построения базовой модели с неоткалиброванными параметрами необходимо ввести целевую функцию, минимизация которой и является ключевым этапом калибровки модели. Согласно  %REF: Быкова,  стр 26
, в качестве  целевой функции может быть выбрано среднеквадратичное отклонение результатов работы модели от  реально наблюдаемых результатов для больных, умерших и выздоровевших по отдельности. Введение целевой функции позволяет численно, т.е аналитически, сравнивать результаты запусков модели с различными параметрами.
После введения целевой функции появляется возможность провести стохастический и оптимизационный эксперименты.

Стохастический эксперимент является базовым на начальном этапе настройки модели, т.к многократным повторением эксперимента достигается возможность получения достоверных выводов о работе модели в целом. Очевидно, что при наличии стохастического параметра модели, недостаточно будет одного прогона. Количество итераций обосновано в  %REF: КондратьевM.A.Разработкамоделираспространенияинфекционныхзаболеванийнаосновеагентногоподхода.––Санкт-Петербург, 2012. 
и было использовано при проведении данного эксперимента. 
%IMG: гистограммы по стохаст экспер по Infected, Dead, Recovered

На гистограммах выше можно каждая линия указывает на результаты одного из 2000 стохастически моделируемых прогноза эпидемии.  Более плотный цвет указывает на большую вероятность попадания данных эксперимента в указанное значение в указанный момент времени. Следует отметить, что наличие только одного стохастического параметра (<<Exposed>>, т.е начальное количество людей в инкубационном периоде, нормально распределённое в интервале [1; 10]) приводит  к незначительному разбросу между прогнозами.

Идея эксперимента заключается в многократном выполнении модели с итеративным изменением параметров, подлежащих уточнению, для улучшения модели. Для эксперимента использовались средства AnyLogic  и системы компьютерной алгебры Wolfram Mathematica. По окончанию эксперимента возможно наблюдать лучшую итерацию, её оптимизированные параметры, значение целевой функции для каждого интересующего нас состояния.
